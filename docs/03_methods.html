<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Air Quality Alerts and School Absenteeism in New York City - Methodology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Air Quality Alerts and School Absenteeism in New York City</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./about.html" aria-current="page">Home</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/gsaabogado"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/gsaabogado"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://luissarmiento.net/">Personal Site</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Methodology</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Sections</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_data.html" class="sidebar-item-text sidebar-link">Data Sets</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_DescStatistics.html" class="sidebar-item-text sidebar-link">Descriptive Statistics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_methods.html" class="sidebar-item-text sidebar-link active">Methodology</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_regressions.html" class="sidebar-item-text sidebar-link">Results</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#regression-discontinuity" id="toc-regression-discontinuity" class="nav-link active" data-scroll-target="#regression-discontinuity">Regression Discontinuity</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Methodology</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="regression-discontinuity" class="level1">
<h1>Regression Discontinuity</h1>
<p>First, I infer causality with a regression discontinuity design (RD). The RD exploits the quasi-random allocation of air quality alerts around the emission threshold to infer causality. The central assumption is that days with forecasted AQI values very close to the alert at either side of the emission threshold only differ because of the alert and not because of concomitant factors like weather or air pollution. Under this assumption, the difference in the expected value of school absences on days just below and above the emission threshold is the local average treatment effect on the treated around the discontinuity.</p>
<p>The following panel shows the data-driven sharp discontinuity RD plot of school absences as a function of the AQI. The left panel contains a natural linear fit to the left and right sides of the discontinuity. In contrast, the right panel adjusts the polynomial fit with weekday, school year, month, and school period fixed effects alongside weather covariates in the form of average, minimum, and maximum temperature, precipitation, wind speed, and relative humidity. The graphical representation of the discontinuity suggests a jump in school absences after the alert.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="RegResults/01_images/RawRdPlot.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Discontinuity in school absences around the alert threshold</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="RegResults/01_images/CovRdPlot.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Discontinuity in school absences around the alert threshold (Covariate Adjusted)</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p>A central assumption of the RD is that no discontinuous unobservables affect both the score and dependant variables. Unfortunately, in the case of air quality alerts in New York, this is not the case. For instance, if both the likelihood of an alert and school absences are consistently higher on Mondays, we may capture the Monday instead of the alertâ€™s effect. To control for the discontinuous impact of this kind of temporal covariates, I run three additional specifications to the raw RD. The first one adds weekday, month, school year, school period, and holiday fixed effects, while the second one further includes average, minimum, and maximum temperature, precipitation, wind speed, and relative humidity as weather covariates. Equation RD specifies the functional form of the preferred model.</p>
<p><span class="math display">\[
Absent_{nt}  =  \beta D_{t}(AQI_{t} \geq 101) + \tilde{\mu}^- f(AQI_t)+ \tilde{\mu}^+ f(AQI{_t}\times D_{nt}) +  W'_{nt} \Delta + \Omega_{t} + \epsilon_{t}
\]</span></p>
<p>In it, <span class="math inline">\(Absent_{nt}\)</span> is the log of absent students at neighborhood <span class="math inline">\(n\)</span> on day <span class="math inline">\(t\)</span>, <span class="math inline">\(AQI_{t}\)</span> is the AQI forecast at time <span class="math inline">\(t\)</span>, and <span class="math inline">\(D_{t}\)</span> the treatment indicator equal to one when the AQI is higher than one hundred units. <span class="math inline">\(f(AQI_{t}\times D_{nt})\)</span> is a linear fit before (<span class="math inline">\(\tilde{\mu}_{-}\)</span>) and after (<span class="math inline">\(\tilde{\mu}_{+}\)</span>) the discontinuity; I use a linear fit because it performs better and has more accurate boundary properties than higher-order polynomials . <span class="math inline">\(W'_{nt}\)</span> and <span class="math inline">\(\Omega_{t}\)</span> are matrices of weather controls and time fixed-effects. The estimate of interest, <span class="math inline">\(\beta\)</span>, captures the of the alert on school absences around the emission threshold. finally, the bandwidth around the discontinuity comes from the data-driven plug-in rules based on mean squared error expansions proposed by .</p>
<p>The RD strategy is suitable to assess the effect of the alert as parents, schools, or neighborhoods cannot manipulate the AQI or the emission of the alert. Furthermore, there is perfect compliance between the alertâ€™s emission and the running variable as every time the AQI forecast surpasses one hundred units, the probability of the alert jumps from zero to one. Still, there remains the possibility that New Yorkers conditional expectation of an alert would rely on the raw AQI independent of the forecast. Thus, similar to , I provide robust estimates for a fuzzy regression discontinuity design, which exploits the discontinuity in the probability of assignment to treatment to infer causality.</p>
<p>Besides the fuzzy RD, I perform three robustness exercises in case the fixed effects are not flexible enough to reduce the bias from correlated temporal covariates. First, I run the RD for a matched data set of treatment and control units. I match both groups with propensity score matching based on weather covariates, the weekday, and the month of the observation. Second, I estimate a two-stage RD with the residuals of a Poisson pseudo-maximum likelihood estimator panel model of school absences as a function of selected weather covariates and fixed effects. Third, I estimate a two-stage least-squares (2sls) Poisson MLE with the difference between the actual and forecasted AQI in linear and quadratic form as instruments for the alert</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>